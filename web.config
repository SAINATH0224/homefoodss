<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.webServer>
    <!-- Security rules for IIS -->
    <security>
      <requestFiltering>
        <!-- Deny access to config files -->
        <hiddenSegments>
          <add segment="config.js" />
          <add segment="config.sample.js" />
          <add segment=".env" />
          <add segment=".env.example" />
        </hiddenSegments>
        
        <!-- Deny access to file extensions -->
        <fileExtensions>
          <add fileExtension=".env" allowed="false" />
          <add fileExtension=".bak" allowed="false" />
          <add fileExtension=".backup" allowed="false" />
        </fileExtensions>
      </requestFiltering>
    </security>
    
    <!-- Custom error pages -->
    <httpErrors errorMode="Custom">
      <remove statusCode="403" subStatusCode="-1" />
      <error statusCode="403" responseMode="ExecuteURL" path="/error/403.html" />
      <remove statusCode="404" subStatusCode="-1" />
      <error statusCode="404" responseMode="ExecuteURL" path="/error/404.html" />
    </httpErrors>
    
    <!-- Security headers -->
    <httpProtocol>
      <customHeaders>
        <add name="X-Content-Type-Options" value="nosniff" />
        <add name="X-Frame-Options" value="DENY" />
        <add name="X-XSS-Protection" value="1; mode=block" />
        <add name="Strict-Transport-Security" value="max-age=31536000; includeSubDomains" />
        <add name="Content-Security-Policy" value="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://www.gstatic.com https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net; img-src 'self' data: https:; connect-src 'self' https://firestore.googleapis.com https://identitytoolkit.googleapis.com https://abhi-red-one.vercel.app" />
      </customHeaders>
    </httpProtocol>
  </system.webServer>
</configuration>
